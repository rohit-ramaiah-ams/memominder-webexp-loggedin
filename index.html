<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Memo Minder</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" crossorigin="anonymous">
    <script src="https://cdn.amplitude.com/libs/analytics-browser-2.9.0-min.js.gz"></script>
    <script src="https://cdn.amplitude.com/libs/plugin-session-replay-browser-1.4.0-min.js.gz"></script>
    <script src="js/memominder.js"></script>
    <script>
      const sessionReplayTracking = window.sessionReplay.plugin();
      window.amplitude.add(sessionReplayTracking);
      window.amplitude.init("383a067bf6e6a9ff502156492a2bdeb8");
    </script>

    <style>
      .login-container {
        position: absolute;
        top: 10px;
        right: 20px;
        text-align: right;
      }
    </style>

    <script>
      const users = {
        Rohit1234: "password",
        Maja1234: "password",
        Salva1234: "password"
      };

      let currentUser = null;

      function loginUser(event) {
        event.preventDefault();
        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        if (users[username] && users[username] === password) {
          currentUser = username;
          document.getElementById("login-form").style.display = "none";
          document.getElementById("welcome-message").innerText = `Welcome, ${currentUser}`;
          document.getElementById("logout-button").style.display = "inline";

          // Amplitude Identify and Login Event
          const identify = new amplitude.Identify()
            .set("user_type", "dummy")
            .set("targetinguserProp", username === "Rohit1234" ? "targetUser" : "do-nottargetUSer");
          amplitude.identify(identify);
          amplitude.setUserId(currentUser);
          amplitude.track("login");

        } else {
          alert("Invalid credentials!");
        }
      }

      function logoutUser() {
        amplitude.track("logout", { user: currentUser });
        amplitude.reset();

        currentUser = null;
        document.getElementById("login-form").style.display = "inline";
        document.getElementById("welcome-message").innerText = "";
        document.getElementById("logout-button").style.display = "none";
      }

      function setLabel() {
        console.log("Setting label");
        document.getElementById("add-memo").innerHTML = "New Memo";
        document.getElementById("add-memo").style.visibility = "";
      }
    </script>
  </head>

  <body onload="setLabel()">
    <div class="login-container">
      <form id="login-form" class="pure-form" onsubmit="loginUser(event)">
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button type="submit" class="pure-button pure-button-primary">Login</button>
      </form>
      <span id="welcome-message"></span>
      <button id="logout-button" class="pure-button" style="display:none" onclick="logoutUser()">Logout</button>
    </div>

    <div class="pure-g">
      <div class="pure-u-3-24"></div>
      <div class="pure-u-18-24">
        <h1>Memo Minder</h1>
        <form class="pure-form pure-form-stacked" id="memo-input-form">
          <fieldset>
            <legend><b>Add Reminder</b></legend>
            <label for="memo-subject">Subject</label>
            <input type="text" id="memo-subject" size="80" placeholder="Enter the memo subject ...">
            <label for="memo-priority">Priority</label>
            <select id="memo-priority">
              <option value="Low">Low</option>
              <option value="Medium">Medium</option>
              <option value="High">High</option>
            </select>
            <button type="submit" style="visibility:hidden" id="add-memo" class="pure-button pure-button-primary">Add</button>
          </fieldset>
          <hr>
        </form>
        <div id="memosList">
          <table class="pure-table pure-table-horizontal">
            <thead><tr><th>Subject</th><th>Priority</th><th>Status</th><th></th><th></th></tr></thead>
            <p></p>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
